# Bedrock AgentCore Cognito認証セットアップ

このディレクトリには、Bedrock AgentCoreアプリケーション用のAWS Cognito認証をセットアップおよび管理するためのスクリプトが含まれています。

## クイック セットアップ

迅速で簡単なセットアップには、セットアップ スクリプトを使用してください：

```bash
./setup_cognito.sh
```

このスクリプトは以下を実行します：
1. AWS認証情報と必要なツール（AWS CLI、jq）をチェック
2. 適切なデフォルト値で必要な情報を求めます：
   - AWSリージョン
   - ユーザー プール名
   - アプリ クライアント名
   - テスト ユーザー認証情報
3. Cognitoユーザー プールとアプリ クライアントを作成
4. 指定された認証情報でテスト ユーザーを作成
5. 即座に使用するためのアクセス トークンを生成
6. 簡単にアクセス可能なファイルにすべての設定を保存

## 設定ファイル

セットアップ スクリプトを実行した後、以下のファイルが作成されます：

- `cognito_config.json` - すべての設定詳細とアクセス トークンを含む
- `cognito_result.md` - ドキュメント用のセットアップの整理された要約

## アクセス トークンの更新

Cognitoアクセス トークンはデフォルトで1時間後に期限が切れます。トークンを更新するには：

```bash
./refresh_token.sh
```

これにより以下が実行されます：
1. 設定ファイルに保存された認証情報を使用
2. Cognitoから新しいアクセス トークンを要求
3. 設定ファイルを自動的に更新

## 必要な権限

これらのスクリプトを実行するには、AWSユーザーは以下の権限を持つ必要があります：

- Amazon Cognito Identity Providerフル アクセス（`cognito-idp:*`）
- または最低限、以下への権限：
  - CreateUserPool
  - CreateUserPoolClient
  - AdminCreateUser
  - AdminSetUserPassword
  - InitiateAuth

## 前提条件

- 適切な権限で設定されたAWS CLIがインストールされている
- 出力を解析するためのjq（JSONプロセッサ）がインストールされている

## セキュリティ ノート

- 作成されたユーザー プールはセキュリティのベスト プラクティスに従います
- パスワード ポリシーはセットアップ スクリプトで調整できます
- 本番使用では、追加のセキュリティ対策を検討してください：
  - 多要素認証
  - カスタム パスワード ポリシー
  - トークン取り消し戦略