# AgentCore Memory：短期記憶

## 概要

Amazon Bedrock AgentCoreの短期記憶は、即座の会話コンテキストとセッションベースの情報管理を提供します。AIエージェントが単一のインタラクションまたは密接に関連するセッション内で継続性を維持し、会話全体を通して一貫性があり、コンテキストを理解したレスポンスを確保できるようにします。

## 短期記憶とは何か？

短期記憶の焦点：

- **セッション継続性**：単一の会話セッション内でコンテキストを維持する
- **即座のコンテキスト**：一貫したレスポンスのために最近の会話履歴を保持する
- **一時的な状態**：現在のインタラクションに関連する一時的な情報を管理する
- **会話の流れ**：セッション内でのトピック間のスムーズな移行を確保する

## AgentCoreでの短期記憶の仕組み

### イベントストレージ

AgentCore Memoryは、完全な会話イベントを生の形式で保存し、以下への即座のアクセスを提供します：

- 最後の`k`個のユーザーメッセージとエージェントレスポンス
- 会話メタデータ（タイムスタンプ、セッションID、アクターID）
- 複雑なインタラクションのための分岐会話パス

### セッション管理

短期記憶はセッションレベルで動作します：

- 各会話セッションは独自のコンテキストを維持する
- 関連するセッションは、セッショングループ化を通じてコンテキストを共有できる
- 期限切れセッションデータの自動クリーンアップ（設定されたTTLに基づく）

### リアルタイムアクセス

バックグラウンドで処理される長期記憶戦略とは異なり、短期記憶は以下を提供します：

- 最近の会話履歴の即座の取得
- セッションが中断またはエージェントが失敗した場合の会話継続
- 会話の進行に応じたリアルタイムコンテキスト更新
- セッション固有情報への低レイテンシアクセス

## ベストプラクティス

1. **コンテキストウィンドウ管理**：オーバーフローを防ぐためにコンテキスト使用量を監視する
2. **セッション境界**：セッションの開始と終了を明確に定義する
3. **メモリクリーンアップ**：期限切れセッションに対して適切なクリーンアップポリシーを実装する
4. **エラーハンドリング**：メモリ取得の失敗を適切に処理する
5. **パフォーマンス最適化**：大きな会話履歴に対して効率的なクエリパターン（例：長期記憶のSummary Strategy経由）を使用する

## フレームワークとの統合

短期記憶は、人気のあるエージェントフレームワークとシームレスに統合されます：

- **Strands Agent**：会話フックとのネイティブ統合
- **LangGraph**：状態管理の統合
- **カスタムフレームワーク**：柔軟な実装のための直接API アクセス

## 利用可能なサンプルノートブック

短期記憶の実装を学ぶための実践的な例を探索してください：

| フレームワーク | ユースケース | 説明 | ノートブック | アーキテクチャ |
| ------------- | --------------- | ------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| Strands Agent | パーソナルエージェント | セッション内で会話コンテキストを維持し、ユーザーインタラクションを記憶するAIアシスタント | [personal-agent.ipynb](./01-single-agent/with-strands-agent/personal-agent.ipynb) | [表示](./01-single-agent/with-strands-agent/architecture.png) |
| LangGraph | フィットネスコーチ | トレーニングセッション全体でワークアウトの進捗を追跡し、コンテキストを維持するパーソナルフィットネスコーチ | [personal-fitness-coach.ipynb](./01-single-agent/with-langgraph-agent/personal-fitness-coach.ipynb) | [表示](./01-single-agent/with-langgraph-agent/architecture.png) |
| Strands Agent | 旅行計画 | 複雑な旅行日程を計画する際にコンテキストを共有する協調エージェント | [travel-planning-agent.ipynb](./02-multi-agent/with-strands-agent/travel-planning-agent.ipynb) | [表示](./02-multi-agent/with-strands-agent/architecture.png) |

## 使い始める

1. あなたのユースケースに合うサンプルを選択する
2. サンプルフォルダに移動する
3. 要件をインストールする：`pip install -r requirements.txt`
4. Jupyterノートブックを開き、ステップバイステップの実装に従う

## 次のステップ

短期記憶に慣れたら、[長期記憶](../02-long-term-memory/)を探索して、複数の会話とセッションにわたって動作する永続的な記憶戦略について学びます。